<!-- 1. create HTML5 doctype -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">

  <!-- 2. include meta tag to ensure proper rendering and touch zooming
         (bootstrap is designed to be responsive to mobile.
         Mobile-first styles are part of the core framework.)
   -->  
 <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- the width=device-width part sets the width of the page to follow
          the screen-width of the device (which wil vary depending on the device)
       the initial-scale=1 part sets the initialize zoom level when the page 
          is first loaded by the browser. 
   --> 
  
  <!-- The above 2 meta tags *must* come first in the head; any other head content must come *after* these tags -->   
  <title>Example: HTML, CSS and bootstrap, JS and DOM</title>    
  
  <!-- 3. link bootstrap pages   -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">  
  
  <script type="text/javascript">
    function setFocus()
    {
       document.mainform.desc.focus();   // access element of document by name (element with name="desc" of form with name="mainform") and set focus on it
       document.getElementById("taskdesc").focus();   // access element of document with id="taskdesc" and set focus on it
       document.forms[0].elements[0].focus();  // access element of document by position (in case name and id are unavailable or unknown)
                                                  // (the first form --index 0-- of this document, the first element --index 0-- of this form)
                                                  
       // to access an element of DOM by name, the element must have name attribute in the opening tag
       // to access an element of DOM by id, the element must have id attribute in the opening tag
    }
  </script>
  
  <style>
    .error {
       color: red;
       font-style: italic;
    }
  </style>
  
</head>

<body onload="setFocus();"> 

  <div class="container">
    <h1>To Do List</h1>
    
  <!-- 4. use bootstrap form layouts
          Bootstrap provides three types of form layouts: 
            - veritcal form (default)
            - horizontal form
            - inline form
          Standard rules for all three form layouts: 
            - wrap labels and form controls in <div class="form-group">
              (needed for optimum spacing) 
            - add class .form-control to all textual <input>, <textarea>, 
              and <select> elements
     --> 
     
    <!-- <label> tag defines a label for an <input> element.
         It does not render as anything special for the user. 
         It provides a usability improvement for mouse useres, because 
         if the user clicks on the text within the <label> element,
         it toggles the control. 
         The for attribute of the <label> tag should be equal to the id attribute
         of the related element to bind them together. 
     -->
     
    <!-- Bootstrap provides several different styles of buttons.
         Here, we use the basic, default style 
     -->
     
    <!-- <form name="mainform" action="" method="get"> -->
    <form name="mainform" >

      <div class="form-group">
        <label for="workout_title">Workout Title</label>
        <!-- <input type="text" id="taskdesc" class="form-control" name="desc" /> -->
        <span class="error" id="workout_error"></span>        
        
       <!-- 5. To set focus (i.e., put a cursor) in a particular form input, 
               an <input> tag's autofocus attribute may be used 
               and thus the html form will have the following <input> tag -->
        <input type="text" id="workoutdesc" class="form-control" name="desc" autofocus />
       
       <!-- Alternatively, we can use a JS function to set focus when the page is loaded 
            (that is, on <body> load). Thus, we need to add an onload event listener and handle the event. 
            In this example, we add an onload event to <body> tag. -->
        
      </div>
    
      <div class="form-group">
        <label for="taskdesc">Task Description</label>
        <!-- <input type="text" id="taskdesc" class="form-control" name="desc" /> -->
        <span class="error" id="taskdesc-note"></span>        
        
       <!-- 5. To set focus (i.e., put a cursor) in a particular form input, 
               an <input> tag's autofocus attribute may be used 
               and thus the html form will have the following <input> tag -->
        <input type="text" id="taskdesc" class="form-control" name="desc" autofocus />
       
       <!-- Alternatively, we can use a JS function to set focus when the page is loaded 
            (that is, on <body> load). Thus, we need to add an onload event listener and handle the event. 
            In this example, we add an onload event to <body> tag. -->
        
      </div>
      
      <div class="form-group">
        <label for="duedate">Due date</label>  
        <input type="text" id="duedate" class="form-control" placeholder="Format: mm/dd/yyyy or mm/dd/yy and month and date must be in appropriate ranges" />  
        <span class="error" id="duedate-note"></span>
      </div>
      
      <div class="form-group">
        <label for="priority">Priority</label>
        <select id="priority" class="form-control" >
          <option value="normal" selected="selected" >Normal</option>  <!-- set default selection -->
          <option value="high">High</option>
        </select>
      </div>     
                
      <input type="button" class="btn btn-light" id="add" value="Add Task" onclick="addRow()"/> 
    </form>

    <br/>
      
      
  <!-- 6. display to do list using a table
   
       When an HTML document is loaded into a browser, 
       the browser converts the HTML elements into a tree-like structure. 
       This tree is called the DOM tree.  
       To manipulate DOM, there are three ways to access the element
       (i) use the element's id attribute, 
       (ii) use the element's name attribute, and 
       (iii) use the element's position.
       Let's access the element using it's id. 
       To access content of that element, use getElementById(id) method
       To get the current value of the element, use value property
       To set the HTML between the open/closing tags of element, use innerHTML property        
  -->
      
  <!-- A basic Bootstrap table has a light padding and horizontal dividers.
       To use the basic style, use .table class.   
  -->      
    <div id="todo">
      <table id="todoTable" class="table" >
        <thead>   <!-- set table headers -->
          <tr>
            <th>Workout Title</th>
            <th>Task Description</th>
            <th>Due Date</th>
            <th>Priority</th>
            <th>(Remove)</th>
          </tr> 
        </thead>
        
        <!-- JS will dynamically create add new row upon form submission -->
        
      </table> 
    </div>
  </div>
  <br/> 
  <hr/>
          
<div class="container">
  <!-- these buttons are used to demonstrate how to access elements of DOM -->
  <!-- data-* attribute allows us to create custom attributes for later used -->
<!--   <div class="row">
    <div class="col-md-4">  
      <button class="btn btn-secondary" onclick="ChangeFieldByName(this, 'new task desc')" data-change-by="name">Update task description <br/>(access element by name)</button>  
    </div>
    <div class="col-md-4">    
      <button class="btn btn-secondary" onclick="ChangeFieldById(this, 'new task desc')" data-change-by="id">Update task description <br/>(access element by id)</button>
    </div>
    <div class="col-md-4">
      <button class="btn btn-secondary" onclick="ChangeFieldByPosition(this, 'new task desc')" data-change-by="position">Update task description <br/>(access element by position)</button>
    </div>
  </div>  -->
 
<!--   <br/><br/>
  these buttons are used to demonstrate forward(), back(), and go() methods of history objects
  <button class="btn btn-primary" onclick="goForward()">Go Forward</button> &nbsp;&nbsp;
  <button class="btn btn-primary" onclick="goBack()">Go Back</button> &nbsp;&nbsp;
  <button class="btn btn-primary" onclick="goBack2pages()">Go Back 2 pages</button>
  
  <br />
  
  <p id="demo" ></p>  this paragraph is used by displayLocationInfo() to demonstrate the location.href property
  <br />
  <button class="btn btn-secondary" onclick="displayLocationInfo()">Display Location info</button> -->

</div> 

  <script>
  
  /* code to demonstrate how to access DOM  
  function goForward() 
  {
     window.history.forward();
  }
  function goBack() 
  {
     window.history.back();
  }
  function goBack2pages() 
  {
     window.history.go(-2);
  }  

  function displayLocationInfo()
  {
	 // both lines produce the same result 
     // window.document.getElementById("demo").innerHTML = location.href;   
     document.getElementById("demo").innerHTML = location.href;
  }
  
  function ChangeFieldByName(by, str) 
  {
     document.mainform.desc.value = str + " (access element by " + by.getAttribute("data-change-by") + ")";
  }   
  function ChangeFieldById(by, str) 
  {
     document.getElementById("taskdesc").value = str + " (access element by " + by.getAttribute("data-change-by") + ")";  	 
  }
  function ChangeFieldByPosition(by, str) 
  {
     document.forms[0].elements[0].value = str + " (access element by " + by.getAttribute("data-change-by") + ")";  	 
  }      */
  
  // add event listener to the element 
  // when this element gets focus, call a validateTaskDesc function 
  // note: to add an event, don't include the prefix "on" -- e.g., use "click" and "mouseover" not "onclick" and "onmouseover"  
  document.getElementById("taskdesc").addEventListener("focus", validateWorkoutTitle);
  document.getElementById("duedate").addEventListener("focus", validateTaskDesc);
  function validateWorkoutTitle() 
  {
     if (document.getElementById("workoutdesc").value === '')
     {
        // if user needs to fix this element, put cursor to it (reduce excise task)
        // and tell user how to fix it
        document.getElementById("workoutdesc").focus();
        document.getElementById("workout_error").innerHTML = "Please enter workout title";
     }
     else 
    	document.getElementById("workout_error").innerHTML = ""; // if nothing is wrong, let's make sure no left-over message 
  }

  function validateTaskDesc() 
  {
     if (document.getElementById("taskdesc").value === '')
     {
        // if user needs to fix this element, put cursor to it (reduce excise task)
        // and tell user how to fix it
        document.getElementById("taskdesc").focus();
        document.getElementById("taskdesc-note").innerHTML = "Please enter task description";
     }
     else 
    	document.getElementById("taskdesc-note").innerHTML = ""; // if nothing is wrong, let's make sure no left-over message 
  }

  
  function addRow()
  {
	 // use getElementById() method
	 // If the element is found, the method will return the element as an object 	 
	 // If the element is not found, a null is returned	  
     var desc = document.getElementById("taskdesc").value;
     var due = document.getElementById("duedate").value;
     var priority = document.getElementById("priority").value; 
     var title = document.getElementById('workoutdesc').value;
     var removeoption = "<input type=button value=' X ' onClick='delRow()'>";
     
     // Another way to validate taskdesc is to have the checking here 
     // (instead of using an addEventListener() and the validateTaskDesc() function above).       
     if (desc === '')    // check if appropriate data are entered
     {
        document.getElementById("taskdesc").focus();
        document.getElementById("taskdesc-note").innerHTML = "Please enter task description";
     } 
     else
     {
    	document.getElementById("taskdesc-note").innerHTML = ""; 
    	
        if (due === '' || isNaN((new Date(due)).valueOf()))
        {        
           document.getElementById("duedate").focus();
           document.getElementById("duedate-note").innerHTML = 
           	    "Date must be in <code>mm/dd/yyyy</code> or <code>mm/dd/yy</code> format and " + 
        	    "month and date must be in appropriate ranges";
        }
        else
        {
           document.getElementById("duedate-note").innerHTML = "";
    	
           // put all pieces of data in an array for later used to create cell content of a row 
           var rowdata = [title, desc, due, priority, removeoption];
     
           // clear data entries (in the form)
           document.getElementById('workoutdesc').value = "";
           document.getElementById("taskdesc").value = "";
           document.getElementById("duedate").value = "";
           document.getElementById("priority").selectedIndex = "0";   // set to default option
 
           // find a <table> element to add row to (in this example, a table with id="todoTable")
           var tableRef = document.getElementById("todoTable");
     
           // create an empty <tr> element and add it to the table
           // using insertRow(index) method
           var newRow = tableRef.insertRow(tableRef.rows.length);    // table_object.rows.length returns the number of <tr> elements in the collection
           // add event listener, on mouseover, set row index. This will be used when deleting a row
           newRow.onmouseover = function() { 
        	  // rowIndex returns the position of a row in the rows collection of a table
              tableRef.clickedRowIndex = this.rowIndex;     
           };    
           // alternatively, use data-index to store index of the line 
           //  (note: data-* attributes can store arbitrary data with elements)
           // eg: <div id="elem" data-index=3></div>
          
           var newCell = "";       
           var i = 0;
           // insert new cells (<td> elements) at the 1st, 2nd, 3rd, 4th position of the new <tr> element
           // using insertCell(method) method        	      
           while (i < 5)
           {
              newCell = newRow.insertCell(i);
              newCell.innerHTML = rowdata[i];
              newCell.onmouseover = this.rowIndex;
              i++;
           }
        }
     }
  }  
  
  function delRow()
  {
     // since deletion action is unrecoverable, add hesitation to minimize/avoid user error 
	 if (confirm("Press OK to delete. This action is unrecoverable.") == true)   
        document.getElementById("todoTable").deleteRow(document.getElementById("todoTable").clickedRowIndex);
  }
  
  
  
  </script>
  <br/><br/>
  </body>
</html>